{{ partial "header.html" . }}

<div id="app-root">

    <div class="blog-hero">
        <p style="text-transform: uppercase; font-size: 0.8rem; letter-spacing: 2px; color: #999; margin-bottom: 5px;">Topic</p>
        <h1 style="margin-top:0;">#{{ .Title }}</h1>
        <p>
            <i data-lucide="layers" width="14" style="vertical-align: middle;"></i> 
            {{ len .Pages }} items found
        </p>
    </div>

    <div style="background:#ffe; border:1px solid #ebccd1; color:#a94442; padding:10px; font-size:12px; margin-bottom:20px;">
        <strong>DEBUG INFO:</strong><br>
        Found {{ len .Pages }} total pages for this tag.<br>
        Sections found: 
        {{ range .Pages }}
            [<strong>{{ .Section }}</strong>] 
        {{ end }}
    </div>

    {{ $blogPosts := where .Pages "Section" "in" (slice "blog" "blogs") }}
    {{ $microPosts := where .Pages "Section" "in" (slice "thoughts" "microblog") }}

    {{ if gt (len $blogPosts) 0 }}
    <div class="home-section" style="margin-top: 50px;">
        <h2 style="border-bottom: 1px solid #000; padding-bottom: 10px; margin-bottom: 25px;">
            <i data-lucide="pen-tool" width="20"></i> Blog Posts
        </h2>
        
        <div class="blog-list">
            {{ range $blogPosts }}
            <a href="{{ .RelPermalink }}" class="blog-list-item">
                <h3 class="blog-item-title">{{ .Title }}</h3>
                <div class="blog-item-meta">
                    <span class="meta-pill">
                        <i data-lucide="calendar" width="12"></i> {{ .Date.Format "Jan 02, 2006" }}
                    </span>
                    <span class="meta-pill">
                        <i data-lucide="clock" width="12"></i> {{ .ReadingTime }} min read
                    </span>
                </div>
                <p class="blog-item-summary">
                    {{ .Summary | plainify | truncate 180 }}
                </p>
                <div style="margin-top: 8px; font-size: 13px; font-weight: bold; color: var(--primary-blue); display: flex; align-items: center; gap: 4px;">
                    Read Article <i data-lucide="arrow-right" width="12"></i>
                </div>
            </a>
            {{ end }}
        </div>
    </div>
    {{ end }}

    {{ if gt (len $microPosts) 0 }}
    <div class="home-section" style="margin-top: 50px;">
        <h2 style="border-bottom: 1px solid #000; padding-bottom: 10px; margin-bottom: 25px;">
            <i data-lucide="message-square" width="20"></i> Microblog Posts
        </h2>

        <div class="micro-feed">
            {{ range $microPosts }}
            <div class="micro-item">
                <div class="micro-dot"></div>
                <div class="micro-header">
                    <span>{{ .Date.Format "Jan 02, 2006" }}</span>
                    <span>â€¢</span>
                    <a href="{{ .Permalink }}" class="micro-permalink-icon"><i data-lucide="link" width="12"></i></a>
                </div>
                {{ if .Title }}
                <h4 style="margin: 5px 0; font-size: 1rem;">{{ .Title }}</h4>
                {{ end }}
                <div class="micro-content">
                    {{ .Content }}
                </div>
            </div>
            {{ end }}
        </div>
    </div>
    {{ end }}

</div>

<script>
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
</script>

{{ partial "footer.html" . }}