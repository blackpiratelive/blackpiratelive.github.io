{{ partial "header.html" . }}

{{ $blogPosts := where .Pages "Section" "blog" }}
{{ $microPosts := where .Pages "Section" "thoughts" }}
{{ $galleryPosts := where .Pages "Section" "gallery" }}

<div id="post">
    <div id="wrapper">
        <article class="norm">
            <h2 id="title">#{{ .Title }}</h2>
            <p class="thoughts-meta">{{ len .Pages }} items across the site.</p>

            {{ if gt (len $blogPosts) 0 }}
            <section class="writeas-section">
                <h3 class="writeas-section-title">Blog posts</h3>
                <ul class="writeas-list">
                    {{ range $blogPosts }}
                    <li class="writeas-list-item">
                        <span class="writeas-list-date">{{ .Date.Format "2006-01-02" }}</span>
                        <div class="writeas-list-main">
                            <a class="writeas-list-title" href="{{ .RelPermalink }}">{{ .Title }}</a>
                            <span class="writeas-list-tags">{{ .ReadingTime }} min read</span>
                        </div>
                    </li>
                    {{ end }}
                </ul>
            </section>
            {{ end }}

            {{ if gt (len $microPosts) 0 }}
            <section class="writeas-section">
                <h3 class="writeas-section-title">Thoughts</h3>
                <div class="thoughts-list">
                    {{ range $microPosts }}
                    <div class="thought-item">
                        <span class="thought-time">
                            <a href="{{ .Permalink }}">{{ .Date.Format "2006-01-02 15:04" }}</a>
                        </span>
                        <div class="thought-body">
                            {{ if .Title }}
                            <h3>{{ .Title }}</h3>
                            {{ end }}
                            {{ .Content }}
                        </div>
                    </div>
                    {{ end }}
                </div>
            </section>
            {{ end }}

            {{ if gt (len $galleryPosts) 0 }}
            <section class="writeas-section">
                <h3 class="writeas-section-title">Gallery</h3>
                <div class="writeas-masonry">
                    {{ range $galleryPosts }}
                    <a href="{{ .RelPermalink }}" class="writeas-masonry-item">
                        {{ $imgSrc := .Params.image.thumbnail.url | default .Params.image.original.url }}
                        <img src="{{ $imgSrc }}" alt="{{ .Title }}" loading="lazy">
                    </a>
                    {{ end }}
                </div>
            </section>
            {{ end }}
        </article>
    </div>
</div>

{{ partial "footer.html" . }}
