<!-- index.html (host) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sudip - BlackPirateX</title>
  <style>
    body {
      font-family: "Times New Roman", serif;
      background: white;
      color: black;
      line-height: 1.6;
      margin: 0;
      transition: background 0.3s, color 0.3s;
    }

    body.dark { background: #1a1a1a; color: #e0e0e0; }

    .container {
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      padding-left: 1rem;
      padding-right: 1rem;
    }

    main.container { padding-top: 1rem; padding-bottom: 2rem; }

    .dark-toggle { display: none; }

    img { max-width: 100%; height: auto; }

    a { color: #2d8659; text-decoration: underline; }
    a:visited { color: #1f5d3d; }
    body.dark a { color: #4bb583; }
    body.dark a:visited { color: #3a9d6f; }

    hr { border: none; border-top: 1px solid #ccc; margin: 2rem 0; }
    body.dark hr { border-top-color: #444; }

    h1, h2 { font-weight: normal; color: #2d8659; }
    body.dark h1, body.dark h2 { color: #4bb583; }

    ul { list-style-type: disc; padding-left: 2rem; }
    li { margin: 0.5rem 0; }

    blockquote {
      margin: 1rem 0;
      padding-left: 1rem;
      border-left: 3px solid #2d8659;
      font-style: italic;
    }
    body.dark blockquote { border-left-color: #4bb583; }

    .center { text-align: center; }

    iframe {
      width: 100%;
      border: 1px solid #ccc;
      margin: 1rem 0;
      background: white;
    }
    body.dark iframe { border-color: #444; background: #2a2a2a; }
  </style>
</head>
<body>
  {{ partial "header.html" . }}

  <main class="container">
    {{ $me := resources.Get "img/me.jpg" }}
    {{ $me = $me.Resize "300x webp q50" }}
    <img src="{{ $me.RelPermalink }}" alt="Sudip" class="profile-img"/>

    <h1 class="center">Hi, I'm Sudip</h1>
    <p class="center"><i>Zoology Graduate • Web Enthusiast • Duck & Cat Lover</i></p>

    <p>Currently in early twenties. This is a website made to put myself to the world. Zoology graduate, building websites as a hobby, and loves ducks and cats.</p>

    <blockquote>Days of me forgetting are over, days of me remembering have just began.</blockquote>

    <p class="center">
      <a href="https://signal.me/euZPhSnH9hQx1WtHL1PPexXdLWbuFgNXm67RP9buIAse3bqTOzBDVDFKiQrHtFSgoC">Connect on Signal</a>
      &nbsp;•&nbsp;
      <a href="https://guestbook.blackpiratex.com">Sign My Guestbook</a>
    </p>

    <hr/>

    <h2>Latest Thoughts</h2>
    <iframe id="hugo-embed-iframe" src="https://status.blackpiratex.com/embed" scrolling="no" style="min-height: 400px"></iframe>

    <hr/>

    <h2>Last Book I've Read</h2>
    <iframe src="/embed.html" title="Latest Read Book" scrolling="no" style="min-height: 300px"></iframe>
  </main>

  {{ partial "footer.html" . }}

  <script>
    // Dark preference on load
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.body.classList.add('dark');
    }

    // Auto-height for specific embed
    window.addEventListener('message', function (event) {
      if (event.data?.frameHeight && event.data?.frameUrl) {
        const iframes = document.querySelectorAll('iframe');
        iframes.forEach((iframe) => {
          try {
            const iframeUrl = new URL(iframe.src, window.location.origin);
            const messageUrl = new URL(event.data.frameUrl);
            if (iframeUrl.pathname === messageUrl.pathname) {
              iframe.style.height = event.data.frameHeight + 'px';
            }
          } catch (e) {}
        });
      }
    });

    // THEME SYNC: post the current theme to all iframes
    function getCurrentThemeSnapshot() {
      const dark = document.body.classList.contains('dark');
      return {
        type: 'theme',
        dark,
        colors: dark ? {
          bg: '#1a1a1a',
          text: '#e0e0e0',
          accent: '#4bb583',
          accentVisited: '#3a9d6f',
          borderSoft: '#444444'
        } : {
          bg: '#ffffff',
          text: '#000000',
          accent: '#2d8659',
          accentVisited: '#1f5d3d',
          borderSoft: '#cccccc'
        }
      };
    }

    function postThemeToEmbeds() {
      const msg = getCurrentThemeSnapshot();
      document.querySelectorAll('iframe').forEach((f) => {
        try { f.contentWindow.postMessage(msg, '*'); } catch (e) {}
      });
    }

    window.addEventListener('load', () => {
      postThemeToEmbeds();
      setTimeout(postThemeToEmbeds, 300);
    });

    // Hook theme toggle button if present
    document.addEventListener('click', (e) => {
      const t = e.target;
      if (t && t.classList && t.classList.contains('theme-toggle')) {
        setTimeout(postThemeToEmbeds, 0);
      }
    });

    // Reflect OS scheme changes as well
    try {
      const mql = window.matchMedia('(prefers-color-scheme: dark)');
      mql.addEventListener('change', () => postThemeToEmbeds());
    } catch (e) {}
  </script>
</body>
</html>