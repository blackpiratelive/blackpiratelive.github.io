<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }} | {{ .Site.Title }}</title>
    
    <link rel="stylesheet" href="{{ "css/micro.css" | relURL }}">
    
    <script src="{{ "js/vendor/lucide.min.js" | relURL }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.js"></script>
    <script src="{{ "js/search.js" | relURL }}"></script>
</head>
<body>

    <div id="header-container">
        <a href="{{ .Site.BaseURL }}" class="header-title">
            <i data-lucide="pen-tool" style="margin-right: 8px;"></i>
            {{ .Site.Title }}
        </a>
        <div class="header-subtitle">
            {{ .Site.Params.subtitle | default "Notes, thoughts, and code snippets from my daily life." }}
        </div>

        <div class="nav-bar">
            <a class="nav-link" href="{{ .Site.BaseURL }}">
                <i data-lucide="layout-dashboard" width="14"></i> Home
            </a>
            <span class="nav-separator">|</span>
            <a class="nav-link" href="{{ "blog" | relURL }}">
                <i data-lucide="book-open" width="14"></i> Blog
            </a>
            <span class="nav-separator">|</span>
            <a class="nav-link" href="{{ "thoughts" | relURL }}">
                <i data-lucide="brain-circuit" width="14"></i> Thoughts
            </a>
            <span class="nav-separator">|</span>
            <a class="nav-link" href="{{ "gallery" | relURL }}">
                <i data-lucide="image" width="14"></i> Gallery
            </a>
            <span class="nav-separator">|</span>
            <a class="nav-link" href="{{ "stats" | relURL }}">
                <i data-lucide="trending-up" width="14"></i> Stats
            </a>
            <span class="nav-separator">|</span>
            <a class="nav-link" href="{{ "on-this-day" | relURL }}">
                <i data-lucide="calendar-days" width="14"></i> On This Day
            </a>
            <span class="nav-separator">|</span>
            <a class="nav-link" href="{{ "search" | relURL }}">
                <i data-lucide="search" width="14"></i> Search
            </a>
            <span class="nav-separator">|</span>
            <button class="nav-link theme-toggle" type="button" aria-pressed="false">
                <i data-lucide="moon" width="14"></i> Theme
            </button>
        </div>
    </div>

    <script>
        (function () {
            const storageKey = "bp-theme";
            const root = document.documentElement;
            const toggle = document.querySelector(".theme-toggle");

            const applyTheme = (value) => {
                if (value === "dark") {
                    root.setAttribute("data-theme", "dark");
                } else {
                    root.removeAttribute("data-theme");
                }
                if (toggle) {
                    const pressed = value === "dark";
                    toggle.setAttribute("aria-pressed", pressed ? "true" : "false");
                    const icon = toggle.querySelector("i");
                    if (icon) {
                        icon.setAttribute("data-lucide", pressed ? "sun" : "moon");
                    }
                    if (typeof lucide !== "undefined") {
                        lucide.createIcons();
                    }
                }
            };

            let theme = localStorage.getItem(storageKey);
            if (!theme && window.matchMedia) {
                theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
            }
            applyTheme(theme || "light");

            if (toggle) {
                toggle.addEventListener("click", () => {
                    const next = root.getAttribute("data-theme") === "dark" ? "light" : "dark";
                    localStorage.setItem(storageKey, next);
                    applyTheme(next);
                });
            }
        })();
    </script>
